<div class="container">

  <!-- TITLE ONLY (NO HOME HERE) -->
  <h2>Booking History</h2>

  <!-- SEARCH + CREATE ROW -->
  <div class="search-create-row">

    <!-- SEARCH (CENTER) -->
    <div class="search-container">
      <input type="text"
             [(ngModel)]="searchLayoutName"
             (keyup)="onSearch()"
             placeholder="Search Layout Name"
             class="search-input">

      <input type="text"
             [(ngModel)]="searchPlotNo"
             (keyup)="onSearch()"
             placeholder="Search Plot No"
             class="search-input">

      <button class="search-btn" (click)="onSearch()">Search</button>
    </div>

    <!-- CREATE (RIGHT) -->
    <div class="top-buttons">
      <button class="btn btn-success" (click)="goToCreate()">
        <i class="fa fa-plus"></i> New Booking
      </button>
    </div>

  </div>

  <!-- LOADING -->
  <div *ngIf="loading" class="loading">Loading bookings...</div>

  <!-- TABLE -->
  <div class="table-wrapper" *ngIf="!loading && bookingList.length > 0">
    <table class="layout-table">

      <thead>
        <tr>
          <th>ID</th>
          <th>Layout Name</th>
          <th>Plot No</th>
          <th>Customer</th>
          <th>Mobile</th>
          <th>Sqft</th>
          <th>Price</th>
          <th>Paid</th>
          <th>Balance</th>
          <th>Direction</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let b of paginatedBookings">
          <td>{{ b.bookingId }}</td>
          <td class="left-align">{{ b.layout?.layoutName }}</td>
          <td>{{ b.plot?.plotNo }}</td>
          <td class="left-align">{{ b.customer?.firstName }}</td>
          <td>{{ b.customer?.mobileNo }}</td>
          <td>{{ b.sqft }}</td>
          <td>{{ b.price | currency:'INR' }}</td>
          <td>{{ getTotalPaid(b) | currency:'INR' }}</td>
          <td>{{ getBalance(b) | currency:'INR' }}</td>
          <td>{{ b.direction }}</td>
          <td>{{ b.status }}</td>

          <!-- ACTION ICONS -->
          <td>
            <div class="action-icons">
              <!-- View -->
              <i class="fa fa-eye circle-icon view"
                 [routerLink]="['/view-booking', b.bookingId]"
                 title="View Details"></i>

              <!-- Edit -->
              <i class="fa fa-pencil circle-icon edit"
                 [routerLink]="['/edit-booking', b.bookingId]"
                 title="Edit Booking"></i>

              <!-- History -->
              <button class="btn btn-history"
                      (click)="viewHistory(b)"
                      title="View complete booking history for this plot">
                <i class="fa fa-clock-rotate-left"></i> History
              </button>

              <!-- Delete -->
              <button class="btn btn-delete"
                      (click)="deleteBooking(b)"
                      title="Cancel Booking">
                <i class="fa fa-trash"></i>
              </button>
            </div>
          </td>
        </tr>
      </tbody>

    </table>
  </div>

  <!-- PAGINATION + HOME -->
  <div class="pagination-container" *ngIf="!loading && bookingList.length > 0">

    <div class="pagination">
      <!-- Prev -->
      <button [disabled]="currentPage === 1" (click)="prevPage()">« Prev</button>

      <!-- Page Numbers -->
      <button *ngFor="let page of pages"
              [class.active]="page === currentPage"
              (click)="goToPage(page)">
        {{ page }}
      </button>

      <!-- Next -->
      <button [disabled]="currentPage === totalPages" (click)="nextPage()">Next »</button>
    </div>

    <!-- Home Button -->
    <button class="btn btn-danger pagination-home-btn" (click)="goHome()">
      Home
    </button>

  </div>

  <!-- NO DATA -->
  <div *ngIf="!loading && bookingList.length === 0" class="no-records">
    No bookings found.
  </div>

</div>
