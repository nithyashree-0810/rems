<div class="form-container">

  <div class="top-bar">
    <button class="view-btn" routerLink="/plots">View Plots</button>

    <label class="upload-btn">
      Bulk Upload Excel
      <input type="file"
             (change)="uploadExcel($event)"
             accept=".xlsx,.xls"
             hidden>
    </label>
  </div>

  <h2 class="form-title">Create New Plot</h2>

  <form #plotForm="ngForm"
        (ngSubmit)="savePlot(plotForm)"
        novalidate
        class="plot-form">

    <!-- Layout + Plot No -->
    <div class="form-row">

      <div class="form-group">
        <label>Layout</label>
        <select [(ngModel)]="newPlot.layout"
                name="layout"
                required
                (change)="onLayoutChange()">
          <option [ngValue]="null">Select Layout</option>
          <option *ngFor="let layout of layouts" [ngValue]="layout">
            {{ layout.layoutName }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label>Plot No</label>
        <input type="text"
               [(ngModel)]="newPlot.plotNo"
               name="plotNo"
               required>
      </div>

    </div>

    <!-- Direction + Survey Number -->
<div class="form-row">

  <div class="form-group">
    <label>Direction</label>
    <select
      [(ngModel)]="newPlot.direction"
      name="direction"
      required>
      <option value="">Select Direction</option>
      <option *ngFor="let d of ['EAST','WEST','NORTH','SOUTH','SOUTHEAST','SOUTHWEST','NORTHEAST','NORTHWEST']">
        {{ d }}
      </option>
    </select>
  </div>

  <div class="form-group">
    <label>Survey No</label>
    <input
      type="text"
      [(ngModel)]="newPlot.surveyNumber"
      name="surveyNumber"
      required
    />
  </div>

</div>



    <!-- Dimensions -->
    <div class="form-row">
      <div class="form-group">
        <label>Total SqFt</label>
        <input type="number"
               [(ngModel)]="newPlot.totalSqft"
               name="totalSqft"
               (input)="calculateValues()">
      </div>

      <div class="form-group">
        <label>Breadth 1</label>
        <input type="number"
               [(ngModel)]="newPlot.breadthOne"
               name="breadthOne"
               (input)="calculateValues()">
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label>Breadth 2</label>
        <input type="number"
               [(ngModel)]="newPlot.breadthTwo"
               name="breadthTwo"
               (input)="calculateValues()">
      </div>

      <div class="form-group">
        <label>Length 1</label>
        <input type="number"
               [(ngModel)]="newPlot.lengthOne"
               name="lengthOne"
               (input)="calculateValues()">
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label>Length 2</label>
        <input type="number"
               [(ngModel)]="newPlot.lengthTwo"
               name="lengthTwo"
               (input)="calculateValues()">
      </div>

      <div class="form-group">
        <label>SqFt Rate</label>
        <input type="number"
               [(ngModel)]="newPlot.sqft"
               name="sqft"
               (input)="calculateValues()">
      </div>
    </div>

    <!-- Price -->
    <div class="form-row">
      <div class="form-group">
        <label>Price</label>
        <input type="number" [(ngModel)]="newPlot.price" name="price" readonly>
      </div>

      <div class="form-group">
        <label>Layout Address</label>
        <input type="text" [(ngModel)]="newPlot.layoutAddress" name="layoutAddress" readonly>
      </div>
    </div>

    <!-- Owner -->
    <div class="form-row">
      <div class="form-group">
        <label>Owner</label>
        <select [(ngModel)]="selectedOwnerId"
                name="ownerId"
                (change)="onOwnerChange()"
                required>
          <option [ngValue]="null">Select Owner</option>
          <option *ngFor="let o of owners" [ngValue]="o.roleId">
            {{ o.firstName }} {{ o.lastName }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label>Address</label>
        <input type="text" [(ngModel)]="newPlot.address" name="address">
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label>Mobile</label>
        <input type="tel"
               [(ngModel)]="newPlot.mobile"
               name="mobile"
               pattern="[0-9]{10}">
      </div>

      <div class="form-group">
        <label>Email</label>
        <input type="email" [(ngModel)]="newPlot.email" name="email">
      </div>
    </div>

    <!-- Checkboxes -->
    <div class="form-row">
      <div class="form-group">
        <label><input type="checkbox" [(ngModel)]="newPlot.dtcpApproved" name="dtcpApproved"> DTCP</label>
      </div>

      <div class="form-group">
        <label><input type="checkbox" [(ngModel)]="newPlot.reraApproved" name="reraApproved"> RERA</label>
      </div>

      <div class="form-group">
        <label><input type="checkbox" [(ngModel)]="newPlot.booked" name="booked"> Booked</label>
      </div>
    </div>

    <!-- Buttons -->
    <div class="form-buttons">
      <button class="btn save-btn" type="submit" [disabled]="plotForm.invalid">
        Save
      </button>

      <button class="btn home-btn" type="button" (click)="goHome()">
        Home
      </button>
    </div>

  </form>
</div>
